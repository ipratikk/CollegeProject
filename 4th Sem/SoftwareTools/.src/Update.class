' Gambas class file

Static Private Top As Integer = 0
Private Val As String

Public Sub Button1_Click()
  Dim tmp As Integer
  Dim tmp2 As Float
  If product.Text = "" Or qty.Text = "" Or Rate.Text = "" Then
    Message.Info("Invalid Entry", "OK")
  Else
    Val = product.Text
    tmp = Check()
    If tmp = -1 Then
      Main.Material[Top] = product.Text
      Main.Quantity[Top] = Val(qty.Text)
      Main.Rate[Top] = Val(Rate.Text)
      ProductsList.Add(Top, product.Text)
      ProductsList[Top][1] = qty.Text
      ProductsList[Top][2] = Rate.Text
      Inc Top
    Else
      If Main.Rate[tmp] == Val(Rate.Text) Then
        Main.Quantity[tmp] = Main.Quantity[tmp] + Val(qty.Text)
        ProductsList.Add(Top, product.Text)
        ProductsList[Top][1] = qty.Text
        ProductsList[Top][2] = Rate.Text
        Inc Top
      Else
        Message.Info("Different Rate for Different Quantity will be added later in future update", "Ok")
      Endif
    Endif
  Endif
End

Public Sub Check() As Integer
  
  Dim i, ind As Integer
  ind = -1
  For i = 0 To Top Step 1
    If Comp(Main.Material[i], Val) == 0 Then
      Return i
    Endif
   Next
  Return ind
End

Public Sub Form_Open()

  init()
  ProductsList.Columns.Count = 3
  ProductsList.Header = 1 'show header 
  ProductsList.Mode = Select.Single
  ProductsList.Columns[0].Text = "Product" 
  ProductsList.Columns[1].Text = "Quantity"
  ProductsList.Columns[2].Text = "Rate" 

End
Public Sub init()
  
  For i As Integer = 0 To 10
    qty.Add(Str(i))
  Next
  
End

Public Sub Button2_Click()

  Main.Top = Top
  Update.Close(0)

End
